var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){var e="object"==("undefined"==typeof self?"undefined":_typeof(self))&&self.self===self&&self||"object"==("undefined"==typeof global?"undefined":_typeof(global))&&global.global===global&&global||this,n=(e.jc,Array.prototype),r=Object.prototype;n.push;slice=n.slice,toString=r.toString,hasOwnProperty=r.hasOwnProperty;var t=Array.isArray,o=Object.keys,s=Object.values?Object.values:function(n){return o(n).map(function(e){return n[e]})},f=(Object.create,function e(n){return n instanceof e?n:this instanceof e?void(this._wrapped=n):new e(n)});function u(e,n,r){return f.isNoVal(e)||f.isNoVal(n)?f.isNoVal(e)?n:e:(r="max"==r?n<e:e<n)?e:n}function l(n,e){var r={};return f.isArray(e)?f.map(e,function(e){r[n+e]=e}):f.isObject(e)?f.forIn(e,function(e,n){r[e]=n}):f.isString(e)&&(r[n+e]=e),r}function p(e,n){var o={},i=e.length,a={};return f.map(e,function(t){f.isObjEmpty(n.colObj)||f.forIn(n.colObj,function(e,n){var r=f.isFunction(n)?n(t):t[n];o[e]=r}),f.isObjEmpty(n.sumObj)||f.forIn(n.sumObj,function(e,n){var r=f.isFunction(n)?n(t):t[n];o[e]?o[e]+=r||0:o[e]=r||0}),f.isObjEmpty(n.avgObj)||f.forIn(n.avgObj,function(e,n){a[e]||(a[e]=0);var r=f.isFunction(n)?n(t):t[n];o[e]?o[e]+=r||0:o[e]=r||0,(r||0==r)&&a[e]++}),f.isObjEmpty(n.maxObj)||f.forIn(n.maxObj,function(e,n){var r=f.isFunction(n)?n(t):t[n];o[e]=u(o[e],r,"max")}),f.isObjEmpty(n.minObj)||f.forIn(n.minObj,function(e,n){var r=f.isFunction(n)?n(t):t[n];o[e]=u(o[e],r,"min")}),f.isObjEmpty(n.countObj)||f.forIn(n.countObj,function(e,n){var r=f.isFunction(n)?n(t):t[n];switch(f.isUndefined(o[e])&&(o[e]=0),e){case"*"==n?e:"count_*":o[e]=i;break;default:f.isUndefined(r)||null==r||o[e]++}})}),f.forIn(n.avgObj,function(e,n){o[e]=o[e]/a[e]}),o}function c(e,n){if(!n)return e;if(f.isObject(n)&&!f.isFunction(n)){var a=o(n),u=s(n);e.sort(function(e,n){for(var r,t,o=a.length,i=0;i<o&&(r=a[i],t=u[i],e[r]===n[r]);i++);if(e[r]!==n[r]){if(e[r]>n[r]||void 0===n[r])return"desc"===t||"DESC"===t?-1:1;if(e[r]<n[r]||void 0===e[r])return"desc"===t||"DESC"===t?1:-1}return"desc"===t||"DESC"===t?n[r]-e[r]:e[r]-n[r]})}else f.isFunction(n)&&e.sort(n);return e}function y(e,n){if(!n&&0!=n)return e;var r=[],t=e.length,o=0;if(f.isNumber(n))t=t<n?t:n;else if(f.isArray(n)){if(n[0]>t)return[];n[0]<t&&(o=n[0]),t=n[0]+n[1]<t?n[0]+n[1]:t}for(;o<t;o++)r.push(e[o]);return r}"undefined"==typeof exports||exports.nodeType?e.jc=f:("undefined"!=typeof module&&!module.nodeType&&module.exports&&(exports=module.exports=f),exports.jc=f),f.VERSION="1.1.0",f.map=function(e,n){return f.isArray(e)?e.map(n):[]},f.forIn=function(e,n){if(!f.isObject(e))return{};var r=0;for(var t in e)n(t,e[t],r),r++},f.filter=function(e,n){return f.isArray(e)?e.filter(n):[]},f.where=function(e,r){var n;if(f.isFunction(r))n=f.filter(e,r);else{if(!f.isObject(r))return[];n=f.filter(e,function(n){return o(r).every(function(e){return r[e]===n[e]})})}return n},f.limit=function(e,n){return y(e,n)},f.order=f.orderBy=function(e,n){return c(e,n)},f.tree=function(e,r){var n;r.children||(r.children="children"),f.isString(r.retain)?n=[r.retain,r.id,r.parent]:f.isArray(r.retain)?((n=r.retain).push(r.id),n.push(r.parent)):f.isObject(r.retain)?((n=r.retain)[r.id]=r.id,n[r.parent]=r.parent):e=f.extend(!0,[],e),n&&(e=f.sql({select:{col:n},from:e}));var t={},o=f.groupBy(e,function(e){return e[r.id]==r.root&&(t=e),e[r.parent]});return f.map(e,function(e){var n=e[r.id];o[n]&&(e[r.children]=o[n])}),f.isObjEmpty(t)&&(t[r.children]=o[r.root]),t},f.extend=function(){var e,n,r,t,o,i,a=arguments[0]||{},u=1,c=arguments.length,s=!1;for("boolean"==typeof a&&(s=a,a=arguments[1]||{},u++),"object"===(void 0===a?"undefined":_typeof(a))||f.isFunction(a)||(a={}),c===u&&(a=this,--u);u<c;u++)if(null!=(e=arguments[u]))for(n in e)r=a[n],a!==(t=e[n])&&(s&&t&&(f.isObject(t)||(o=f.isArray(t)))?(i=o?(o=!1,r&&f.isArray(r)?r:[]):r&&f.isObject(r)?r:{},a[n]=f.extend(s,i,t)):void 0!==t&&(a[n]=t));return a},f.unique=function(e){if(!e||0==e.length)return e;var r={},t=[];f.map(e,function(e){var n=JSON.stringify(e);r[n]=e});return f.forIn(r,function(e,n){t.push(n)}),t},f.spaceFix=function(e,n){if(!e||0==e.length)return e;var r=[];0<e[0][n.key]-n.start&&((s={})[n.key]=n.start,f.map(n.zeroFill,function(e){s[e]=0}),e.unshift(s));e[e.length-1][n.key]<n.end&&((s={})[n.key]=n.end,f.map(n.zeroFill,function(e){s[e]=0}),e.push(s));for(var t=1,o=e.length;t<o&&!(1e4<t);t++){var i=e[t][n.key]-e[t-1][n.key];if(i<=n.space)r.push(e[t]);else{for(var a=n.space,u=0,c=i/n.space;u<c-1&&!(1e4<u);u++){var s;(s={})[n.key]=parseInt(e[t-1][n.key])+parseInt(a),f.map(n.zeroFill,function(e){s[e]=0}),r.push(s),a+=n.space}r.push(e[t])}}return r.unshift(e[0]),r},f.keyArray=function(e,n){if(!e||0==e.length)return e;f.isString(n)&&(n=[n]);var t={};return f.map(e,function(r,e){f.map(n,function(e,n){t[e]||(t[e]=[]),t[e].push(r[e])})}),t},f.keyBreak=function(e,t){if(!e||0==e.length)return e;var o=[],i=t.key,a=t.value;return f.map(e,function(r){f.map(t.break,function(e){var n={};n[i]=e,n[a]=r[e],f.map(t.retain,function(e){n[e]=r[e]}),o.push(n)})}),o},f.index=function(e,n){if(!e||0==e.length)return e;var r={};return f.map(e,function(e){console.log(e.key),r[e[n]]=e}),r},f.max=function(e,t){if(!e||0==e.length)return e;var o;if(f.isString(t)){var n=t;t=function(e){return e[n]}}else f.isUndefined(t)&&(t=function(e){return e});return f.map(e,function(e){var n=o?t(o):o,r=e?t(e):e;o=f.isNoVal(n)||f.isNoVal(r)?f.isNoVal(n)?e:o:r<n?o:e}),o},f.min=function(e,t){if(!e||0==e.length)return e;var o;if(f.isString(t)){var n=t;t=function(e){return e[n]}}else f.isUndefined(t)&&(t=function(e){return e});return f.map(e,function(e){var n=o?t(o):o,r=e?t(e):e;o=f.isNoVal(n)||f.isNoVal(r)?f.isNoVal(n)?e:o:n<r?o:e}),o},f.group=f.groupBy=function(e,n){if(!e||0==e.length)return e;var o={};return f.map(e,function(r,e){var t=[];f.isArray(n)?f.map(n,function(e,n){f.isFunction(e)?t.push(e(r)):t.push(r[e])}):f.isString(n)?t.push(r[n]):f.isFunction(n)&&(t=n(r,e)),o[t]||(o[t]=[]),o[t].push(r)}),o},f.sql=function(e){if(function(e){if(!e.from)throw new Error("From is not defined","Error from");if(!e.select)throw new Error("Select is not defined","Error select");!function(e){var n=e.select,r=e.groupBy;if(!(n.sum||n.avg||n.count||n.max||n.min))return;if(n.col&&!e.groupBy)return;var t=l("",n.col);t=s(t);var o=[],i=!1;f.isArray(r)?f.map(r,function(e,n){o.push(e)}):f.isString(r)?o.push(r):f.isFunction(r)&&(o=[r]);for(var a=0,u=t.length;a<u;a++){for(var c=0;c<u;c++){if(t[a]==o[c]){i=!0;break}if(f.isObject(t[a])&&f.isObject(o[c])&&String(t[a])===String(o[c])){i=!0;break}}if(!i)throw new Error("groupBy should contain select.col","Error groupBy");i=!1}}(e)}(e),0==e.from.length||!f.isArray(e.from))return[];var n,r,t,o,i,a,u=e.from;return r=u,n=(t=e.where)?f.where(r,t):r,o=n,i=e,f.forIn(i.select,function(e,n){a=!("col"==e)||a}),y(c(function(e,n){if(!n)throw new Error("Select is not defined","Error select");var i=[],a={};n.col&&(a.colObj=l("",n.col));n.sum&&(a.sumObj=l("sum_",n.sum));n.avg&&(a.avgObj=l("avg_",n.avg));n.max&&(a.maxObj=l("max_",n.max));n.min&&(a.minObj=l("min_",n.min));n.count&&(a.countObj=l("count_",n.count));f.isArray(e)?f.map(e,function(e,n){var r=p([e],a);i.push(r)}):f.forIn(e,function(e,n,r,t){var o=p(n,a);i.push(o)});return i}(function(e,u){if(!u)return e;var c={sumObj:{},avgObj:{},maxObj:{},minObj:{},countObj:{}},s={};return f.forIn(u,function(e,n){var r=e.split("_"),t=r.shift(),o=r.join("_");switch(o=o.replace(/[1-9a-zA-z_\$\@]+/g,function(e){return"row['"+e+"']"}),t){case"sum":c.sumObj[e]=function(e){return new Function("row","return "+o)(e)};break;case"avg":c.avgObj[e]=function(e){return new Function("row","return "+o)(e)};break;case"max":c.maxObj[e]=function(e){return new Function("row","return "+o)(e)};break;case"min":c.minObj[e]=function(e){return new Function("row","return "+o)(e)};break;case"count":c.countObj[e]=function(e){return new Function("row","return "+o)(e)}}}),f.forIn(e,function(e,n,r,t){var o,i=p(n,c);for(var a in u)if(foo=new Function("return "+i[a]+u[a]),!(o=foo()))break;o&&(s[e]=n)}),s}(i.groupBy||a?i.groupBy||i.select.col?f.group(o,i.groupBy):{table:o}:o,e.having),e.select),e.orderBy),e.limit)},f.isObjEmpty=function(e){for(var n in e)return!1;return!0},f.isNoVal=function(e){return f.isUndefined(e)||null==e||e!=e},f.isArray=t||function(e){return"[object Array]"===toString.call(e)},f.isObject=function(e){return"object"===(void 0===e?"undefined":_typeof(e))&&!f.isArray(e)&&!!e},f.map(["Arguments","Function","String","Number","Date","RegExp","Error","Symbol","Map","WeakMap","Set","WeakSet"],function(n){f["is"+n]=function(e){return{}.toString.call(e)==="[object "+n+"]"}}),f.isUndefined=function(e){return void 0===e},"function"==typeof define&&define.amd&&define("jc",[],function(){return f})}(),function(){var e="object"==("undefined"==typeof self?"undefined":_typeof(self))&&self.self===self&&self||"object"==("undefined"==typeof global?"undefined":_typeof(global))&&global.global===global&&global||this,n=(e.ec,Array.prototype),r=Object.prototype,t=(n.push,n.slice,r.toString,r.hasOwnProperty,Array.isArray,Object.keys),o=(Object.values&&Object.values,Object.create,function e(n){return n instanceof e?n:this instanceof e?void(this._wrapped=n):new e(n)});"undefined"==typeof exports||exports.nodeType?e.ec=o:("undefined"!=typeof module&&!module.nodeType&&module.exports&&(exports=module.exports=o),exports.ec=o),o.VERSION="1.0.0";var l={globalOption:{color:["#1890FF","#2FC25B","#FACC14","#223273","#8543E0","#13C2C2","#3436C7","#F04864"],tooltip:{trigger:"axis"},grid:{top:48,left:16,right:16,bottom:12,containLabel:!0},title:{text:"",top:4,left:10,textStyle:{color:"#333"}},legend:{show:!0,top:8,right:10}}};getOption=function(e,n){var r=jc.extend(!0,{},l.globalOption);r=jc.extend(!0,r,n);var t=void 0;return e.easySet?(r=jc.extend(!0,r,e),t=e.easySet,delete r.easySet):t=e,{chartOption:r,easySet:t}},l.barOption={tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},xAxis:[{type:"category"}],yAxis:[{type:"value"}],series:[{type:"bar"}]},o.barChart=function(e,n){var r=getOption(n,l.barOption),o=r.easySet,t=r.chartOption,i=[],a=[],u=[],c=t.series[0],s=jc.groupBy(e,o.legend);if(jc.sql({select:{col:{key:o.x},sum:{val:o.y}},from:e,groupBy:o.x,orderBy:!!o.orderBy&&{val:o.orderBy}}).map(function(e){var n=e.key;a.push(n)}),jc.forIn(s,function(e,n){jc.keyArray(n,[o.y]);var r=jc.extend(!0,{},c),t=jc.index(n,o.x);i.push(e),r.data=[],jc.map(a,function(e){r.data.push(t[e][o.y])}),r.name=e,o.stack&&(r.stack="总量"),u.push(r)}),t.series=u,t.legend.data=i,t.xAxis[0].data=a,"horizontal"===o.direction){var f;f=t.xAxis[0],t.xAxis[0]=t.yAxis[0],t.yAxis[0]=f}return t},l.lineOption={xAxis:[{type:"category",boundaryGap:!1}],yAxis:[{type:"value"}],series:[{type:"line"}]},o.lineChart=function(e,n){var r=getOption(n,l.lineOption),o=r.easySet,t=r.chartOption,i=[],a=[],u=[],c=t.series[0],s=jc.groupBy(e,o.legend);if(jc.sql({select:{col:{key:o.x},sum:{val:o.y}},from:e,groupBy:o.x,orderBy:!!o.orderBy&&{val:o.orderBy}}).map(function(e){var n=e.key;a.push(n)}),jc.forIn(s,function(e,n){jc.keyArray(n,[o.y]);var r=jc.extend(!0,{},c),t=jc.index(n,o.x);i.push(e),r.data=[],jc.map(a,function(e){r.data.push(t[e])}),r.name=e,o.stack&&(r.stack="总量",r.areaStyle||(r.areaStyle={normal:{}})),u.push(r)}),t.series=u,t.legend.data=i,t.xAxis[0].data=a,"horizontal"===o.direction){var f;f=t.xAxis[0],t.xAxis[0]=t.yAxis[0],t.yAxis[0]=f}return t},l.pieOption={tooltip:{trigger:"item",formatter:"{b}: {c} ({d}%)"},series:[{name:" ",type:"pie",radius:"55%",center:["50%","60%"]}]},o.pieChart=function(e,n){var r,t,o=getOption(n,l.pieOption),i=o.easySet,a=o.chartOption;return r=jc.sql({select:{col:{name:i.legend,value:i.val}},from:e,orderBy:!!i.orderBy&&{value:i.orderBy}}),t=jc.keyArray(r,["name"]).name,a.series[0].data=r,a.legend.data=t,a},l.kOption={tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},xAxis:[{type:"category"}],yAxis:[{type:"value"}],series:[{type:"k",itemStyle:{normal:{color:l.globalOption.color[0],color0:l.globalOption.color[0],borderColor:l.globalOption.color[0],borderColor0:l.globalOption.color[0]}}}]},o.kChart=function(e,n){var r=getOption(n,l.kOption),t=r.easySet,o=r.chartOption,i=[],a=[],u=o.series[0],c=jc.groupBy(e,t.legend);jc.sql({select:{col:{key:t.x,val:t.y}},from:e,groupBy:t.x,orderBy:!!t.orderBy&&{val:t.orderBy}}).map(function(e){var n=e.key;a.push(n)});var s=jc.extend(!0,{},u);if(s.data=[],jc.forIn(c,function(e,n){jc.keyArray(n,[t.y]);var r=jc.index(n,t.x);i.push(e),console.log(),jc.map(a,function(e){console.log(r[e][t.y],e,r,t.y),s.data.push(r[e][t.y])})}),console.log(s,"newSeries"),o.series=s,o.xAxis[0].data=a,"horizontal"===t.direction){var f;f=o.xAxis[0],o.xAxis[0]=o.yAxis[0],o.yAxis[0]=f}return o},jc.forIn(l,function(e,r){o[e]=function(e,n){r=n?jc.extend(!0,r,e):jc.extend(r,e)}}),"function"==typeof define&&define.amd&&define("ec",[],function(){return o})}();