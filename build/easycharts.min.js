!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):(e=e||self).ec=n()}(this,function(){"use strict";var d="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};var e,m=(function(i,o){!function(){var e="object"==typeof self&&self.self===self&&self||"object"==typeof d&&d.global===d&&d||this,n=(e.jc,Array.prototype,Object.prototype.toString),t=Array.isArray,r=Object.keys,c=Object.values?Object.values:function(n){return r(n).map(function(e){return n[e]})},l=function(e){return e instanceof l?e:this instanceof l?void(this._wrapped=e):new l(e)};function u(e,n,t){return l.isNoVal(e)||l.isNoVal(n)?l.isNoVal(e)?n:e:(t="max"==t?n<e:e<n)?e:n}function f(n,e){var t={};return l.isArray(e)?l.map(e,function(e){t[n+e]=e}):l.isObject(e)?l.forIn(e,function(e,n){t[e]=n}):l.isString(e)&&(t[n+e]=e),t}function p(e,n){var i={},o=e.length,a={};return l.map(e,function(r){l.isObjEmpty(n.colObj)||l.forIn(n.colObj,function(e,n){var t=l.isFunction(n)?n(r):r[n];i[e]=t}),l.isObjEmpty(n.sumObj)||l.forIn(n.sumObj,function(e,n){var t=l.isFunction(n)?n(r):r[n];i[e]?i[e]+=t||0:i[e]=t||0}),l.isObjEmpty(n.avgObj)||l.forIn(n.avgObj,function(e,n){a[e]||(a[e]=0);var t=l.isFunction(n)?n(r):r[n];i[e]?i[e]+=t||0:i[e]=t||0,!t&&0!=t||a[e]++}),l.isObjEmpty(n.maxObj)||l.forIn(n.maxObj,function(e,n){var t=l.isFunction(n)?n(r):r[n];i[e]=u(i[e],t,"max")}),l.isObjEmpty(n.minObj)||l.forIn(n.minObj,function(e,n){var t=l.isFunction(n)?n(r):r[n];i[e]=u(i[e],t,"min")}),l.isObjEmpty(n.countObj)||l.forIn(n.countObj,function(e,n){var t=l.isFunction(n)?n(r):r[n];switch(l.isUndefined(i[e])&&(i[e]=0),e){case"*"==n?e:"count_*":i[e]=o;break;default:l.isUndefined(t)||null==t||i[e]++}})}),l.forIn(n.avgObj,function(e,n){i[e]=i[e]/a[e]}),i}function a(e,n){if(!n)return e;if(l.isObject(n)&&!l.isFunction(n)){var a=r(n),u=c(n);e.sort(function(e,n){for(var t,r,i=a.length,o=0;o<i&&(t=a[o],r=u[o],e[t]===n[t]);o++);if(e[t]!==n[t]){if(e[t]>n[t]||void 0===n[t])return"desc"===r||"DESC"===r?-1:1;if(e[t]<n[t]||void 0===e[t])return"desc"===r||"DESC"===r?1:-1}return"desc"===r||"DESC"===r?n[t]-e[t]:e[t]-n[t]})}else l.isFunction(n)&&e.sort(n);return e}function s(e,n){if(!n&&0!=n)return e;var t=[],r=e.length,i=0;if(l.isNumber(n))r=r<n?r:n;else if(l.isArray(n)){if(n[0]>r)return[];n[0]<r&&(i=n[0]),r=n[0]+n[1]<r?n[0]+n[1]:r}for(;i<r;i++)t.push(e[i]);return t}o.nodeType?e.jc=l:(!i.nodeType&&i.exports&&(o=i.exports=l),o.jc=l),l.VERSION="1.1.0",l.map=function(e,n){return l.isArray(e)?e.map(n):[]},l.forIn=function(e,n){if(!l.isObject(e))return{};var t=0;for(var r in e)n(r,e[r],t),t++},l.filter=function(e,n){return l.isArray(e)?e.filter(n):[]},l.where=function(e,t){var n;if(l.isFunction(t))n=l.filter(e,t);else{if(!l.isObject(t))return[];n=l.filter(e,function(n){return r(t).every(function(e){return t[e]===n[e]})})}return n},l.limit=function(e,n){return s(e,n)},l.order=l.orderBy=function(e,n){return a(e,n)},l.tree=function(e,t){var n;t.children||(t.children="children"),l.isString(t.retain)?n=[t.retain,t.id,t.parent]:l.isArray(t.retain)?((n=t.retain).push(t.id),n.push(t.parent)):l.isObject(t.retain)?((n=t.retain)[t.id]=t.id,n[t.parent]=t.parent):e=l.extend(!0,[],e),n&&(e=l.sql({select:{col:n},from:e}));var r={},i=l.groupBy(e,function(e){return e[t.id]==t.root&&(r=e),e[t.parent]});return l.map(e,function(e){var n=e[t.id];i[n]&&(e[t.children]=i[n])}),l.isObjEmpty(r)&&(r[t.children]=i[t.root]),r},l.treeDic=function(e,n){var t={id:"id",children:"children",deleteEmptyChildren:!0};l.isObject(n)&&l.extend(t,n),l.isObject(e)&&(e=[e]);var r={};return function n(e){e.map(function(e){(r[e[t.id]]=e)[t.children]&&0!=e[t.children].length||!t.deleteEmptyChildren?n(e[t.children]):delete e[t.children]})}(e),r},l.treeFilter=function(e,n){var t={root:"0",id:"id",parent:"pid",children:"children",deleteEmptyChildren:!0};l.isObject(n)&&l.extend(t,n),l.isObject(e)&&(e=[e]),e=l.extend([],e);var r=[];!function n(e){e.map(function(e){r.push(e),e[t.children]&&0!=e[t.children].length||!t.deleteEmptyChildren?n(e[t.children]):delete e[t.children]})}(e);var i=l.where(r,t.filter);return l.tree(i,t)},l.treeMap=function(e,n){var t={root:"0",id:"id",parent:"pid",children:"children",deleteEmptyChildren:!0,map:function(e){return e}};return l.isObject(n)&&l.extend(t,n),function n(e){e.map(function(e){t.map(e),e[t.children]&&0!=e[t.children].length||!t.deleteEmptyChildren?n(e[t.children]):delete e[t.children]})}(l.isObject(e)?[e]:e),e},l.treeSearch=function(e,n){var r={children:"children",search:{}};l.isObject(n)&&l.extend(r,n);var t=l.isObject(e)?[e]:e,i=[];return function t(e){e.map(function(e){var n=r.search;0<l.where([e],n).length&&i.push(e),e[r.children]&&0!=e[r.children].length&&t(e[r.children])})}(t),i},l.treePath=function(e,n){var t={root:"0",id:"id",parent:"pid",children:"children",path:""};l.isObject(n)&&l.extend(t,n);var r=l.treeDic(e,t),i=[];return function e(n){r[n]&&(i.unshift(r[n]),r[n][t.parent]&&e(r[n][t.parent]))}(t.path),i},l.extend=function(){var e,n,t,r,i,o,a=arguments[0]||{},u=1,s=arguments.length,c=!1;for("boolean"==typeof a&&(c=a,a=arguments[1]||{},u++),"object"==typeof a||l.isFunction(a)||(a={}),s===u&&(a=this,--u);u<s;u++)if(null!=(e=arguments[u]))for(n in e)t=a[n],a!==(r=e[n])&&(c&&r&&(l.isObject(r)||(i=l.isArray(r)))?(o=i?(i=!1,t&&l.isArray(t)?t:[]):t&&l.isObject(t)?t:{},a[n]=l.extend(c,o,r)):void 0!==r&&(a[n]=r));return a},l.unique=function(e){if(!e||0==e.length)return e;var t={},r=[];return l.map(e,function(e){var n=JSON.stringify(e);t[n]=e}),l.forIn(t,function(e,n){r.push(n)}),r},l.spaceFix=function(e,n){if(!e||0==e.length)return e;var t=[];0<e[0][n.key]-n.start&&((c={})[n.key]=n.start,l.map(n.zeroFill,function(e){c[e]=0}),e.unshift(c)),e[e.length-1][n.key]<n.end&&((c={})[n.key]=n.end,l.map(n.zeroFill,function(e){c[e]=0}),e.push(c));for(var r=1,i=e.length;r<i&&!(1e4<r);r++){var o=e[r][n.key]-e[r-1][n.key];if(o<=n.space)t.push(e[r]);else{for(var a=n.space,u=0,s=o/n.space;u<s-1&&!(1e4<u);u++){var c;(c={})[n.key]=parseInt(e[r-1][n.key])+parseInt(a),l.map(n.zeroFill,function(e){c[e]=0}),t.push(c),a+=n.space}t.push(e[r])}}return t.unshift(e[0]),t},l.keyArray=function(e,n){if(!e||0==e.length)return e;l.isString(n)&&(n=[n]);var r={};return l.map(e,function(t,e){l.map(n,function(e,n){r[e]||(r[e]=[]),r[e].push(t[e])})}),r},l.keyBreak=function(e,r){if(!e||0==e.length)return e;var i=[],o=r.key,a=r.value;return l.map(e,function(t){l.map(r.break,function(e){var n={};n[o]=e,n[a]=t[e],l.map(r.retain,function(e){n[e]=t[e]}),i.push(n)})}),i},l.index=function(e,n){if(!e||0==e.length)return e;var t={};return l.map(e,function(e){t[e[n]]=e}),t},l.max=function(e,r){if(!e||0==e.length)return e;var i;if(l.isString(r)){var n=r;r=function(e){return e[n]}}else l.isUndefined(r)&&(r=function(e){return e});return l.map(e,function(e){var n=i?r(i):i,t=e?r(e):e;i=l.isNoVal(n)||l.isNoVal(t)?l.isNoVal(n)?e:i:t<n?i:e}),i},l.min=function(e,r){if(!e||0==e.length)return e;var i;if(l.isString(r)){var n=r;r=function(e){return e[n]}}else l.isUndefined(r)&&(r=function(e){return e});return l.map(e,function(e){var n=i?r(i):i,t=e?r(e):e;i=l.isNoVal(n)||l.isNoVal(t)?l.isNoVal(n)?e:i:n<t?i:e}),i},l.group=l.groupBy=function(e,n){if(!e||0==e.length)return e;var i={};return l.map(e,function(t,e){var r=[];l.isArray(n)?l.map(n,function(e,n){l.isFunction(e)?r.push(e(t)):r.push(t[e])}):l.isString(n)?r.push(t[n]):l.isFunction(n)&&(r=n(t,e)),i[r]||(i[r]=[]),i[r].push(t)}),i},l.sql=function(e){return function(e){if(!e.from)throw new Error("From is not defined","Error from");if(!e.select)throw new Error("Select is not defined","Error select");!function(e){var n=e.select,t=e.groupBy;if((n.sum||n.avg||n.count||n.max||n.min)&&(!n.col||e.groupBy)){var r=f("",n.col);r=c(r);var i=[],o=!1;l.isArray(t)?l.map(t,function(e,n){i.push(e)}):l.isString(t)?i.push(t):l.isFunction(t)&&(i=[t]);for(var a=0,u=r.length;a<u;a++){for(var s=0;s<u;s++){if(r[a]==i[s]){o=!0;break}if(l.isObject(r[a])&&l.isObject(i[s])&&String(r[a])===String(i[s])){o=!0;break}}if(!o)throw new Error("groupBy should contain select.col","Error groupBy");o=!1}}}(e)}(e),0!=e.from.length&&l.isArray(e.from)?s(a(function(e,n){if(!n)throw new Error("Select is not defined","Error select");var o=[],a={};return n.col&&(a.colObj=f("",n.col)),n.sum&&(a.sumObj=f("sum_",n.sum)),n.avg&&(a.avgObj=f("avg_",n.avg)),n.max&&(a.maxObj=f("max_",n.max)),n.min&&(a.minObj=f("min_",n.min)),n.count&&(a.countObj=f("count_",n.count)),l.isArray(e)?l.map(e,function(e,n){var t=p([e],a);o.push(t)}):l.forIn(e,function(e,n,t,r){var i=p(n,a);o.push(i)}),o}(function(e,u){if(!u)return e;var s={sumObj:{},avgObj:{},maxObj:{},minObj:{},countObj:{}},c={};return l.forIn(u,function(e,n){var t=e.split("_"),r=t.shift(),i=t.join("_");switch(i=i.replace(/[1-9a-zA-z_\$\@]+/g,function(e){return"row['"+e+"']"}),r){case"sum":s.sumObj[e]=function(e){return new Function("row","return "+i)(e)};break;case"avg":s.avgObj[e]=function(e){return new Function("row","return "+i)(e)};break;case"max":s.maxObj[e]=function(e){return new Function("row","return "+i)(e)};break;case"min":s.minObj[e]=function(e){return new Function("row","return "+i)(e)};break;case"count":s.countObj[e]=function(e){return new Function("row","return "+i)(e)}}}),l.forIn(e,function(e,n,t,r){var i,o=p(n,s);for(var a in u)if(foo=new Function("return "+o[a]+u[a]),!(i=foo()))break;i&&(c[e]=n)}),c}((i=e.from,o=e.where,n=o?l.where(i,o):i,t=e,l.forIn(t.select,function(e,n){r=!("col"==e)||r}),t.groupBy||r?t.groupBy||t.select.col?l.group(n,t.groupBy):{table:n}:n),e.having),e.select),e.orderBy),e.limit):[];var n,t,r,i,o},l.isObjEmpty=function(e){for(var n in e)return!1;return!0},l.isNoVal=function(e){return l.isUndefined(e)||null==e||e!=e},l.isArray=t||function(e){return"[object Array]"===n.call(e)},l.isObject=function(e){return"object"==typeof e&&!l.isArray(e)&&!!e},l.map(["Arguments","Function","String","Number","Date","RegExp","Error","Symbol","Map","WeakMap","Set","WeakSet"],function(n){l["is"+n]=function(e){return{}.toString.call(e)==="[object "+n+"]"}}),l.isUndefined=function(e){return void 0===e}}()}(e={exports:{}},e.exports),e.exports),n=(m.jcalculator,m.jc,function e(n){return n instanceof e?n:this instanceof e?void(this._wrapped=n):new e(n)});n.VERSION="1.0.0";var h={globalOption:{color:["#1890FF","#2FC25B","#FACC14","#223273","#8543E0","#13C2C2","#3436C7","#F04864"],tooltip:{trigger:"axis"},grid:{top:48,left:16,right:16,bottom:12,containLabel:!0},title:{text:"",top:4,left:10,textStyle:{color:"#333"}},legend:{show:!0,top:8,right:10}}},x=function(e,n){var t,r=m.extend(!0,{},h.globalOption);return r=m.extend(!0,r,n),e.easySet?(r=m.extend(!0,r,e),t=e.easySet,delete r.easySet):t=e,function(e,n){var t=n.formatter;if(!t)return{chartOption:e,easySet:n};var r=e.tooltip?e.tooltip:{},i=e.label?e.label:{},o=e.legend?e.legend:{},a=e.title?e.title:{},u=e.xAxis&&e.xAxis[0]?e.xAxis[0]:{},s=e.yAxis&&e.yAxis[0]?e.yAxis[0]:{},c=u.axisLabel=u.axisLabel?u.axisLabel:{},l=s.axisLabel=s.axisLabel?s.axisLabel:{};return t.tooltip&&(r.formatter=t.tooltip),t.label&&(i.formatter=t.label),t.legend&&(o.formatter=t.legend),t.xAxis&&(c.formatter=t.xAxis),t.yAxis&&(l.formatter=t.yAxis),t.xName&&(u.name=t.xName),t.yName&&(s.name=t.yName),t.title&&(a.text=t.title),{chartOption:e,easySet:n}}(r,t)};return h.barOption={tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},xAxis:[{type:"category",nameGap:6}],yAxis:[{type:"value",nameGap:6}],series:[{type:"bar"}]},n.barChart=function(e,n){var t,r=x(n,h.barOption),i=r.easySet,o=r.chartOption,a=[],u=[],s=[],c=o.series[0],l=m.groupBy(e,i.legend);(m.sql({select:{col:{key:i.x},sum:{val:i.y}},from:e,groupBy:i.x,orderBy:!!i.orderBy&&{val:i.orderBy}}).map(function(e){var n=e.key;u.push(n)}),m.forIn(l,function(e,n){var t=m.extend(!0,{},c),r=m.index(n,i.x);a.push(e),t.data=[],m.map(u,function(e){t.data.push(r[e][i.y])}),t.name=e,i.stack&&(t.stack="总量"),s.push(t)}),o.series=s,o.legend.data=a,o.xAxis[0].data=u,"horizontal"===i.direction)&&(t=o.xAxis[0],o.xAxis[0]=o.yAxis[0],o.yAxis[0]=t);return o},h.lineOption={xAxis:[{type:"category",boundaryGap:!1}],yAxis:[{type:"value"}],series:[{type:"line"}]},n.lineChart=function(e,n){var t,r=x(n,h.lineOption),i=r.easySet,o=r.chartOption,a=[],u=[],s=[],c=o.series[0],l=m.groupBy(e,i.legend);(m.sql({select:{col:{key:i.x},sum:{val:i.y}},from:e,groupBy:i.x,orderBy:!!i.orderBy&&{val:i.orderBy}}).map(function(e){var n=e.key;u.push(n)}),m.forIn(l,function(e,n){m.keyArray(n,[i.y]);var t=m.extend(!0,{},c),r=m.index(n,i.x);a.push(e),t.data=[],m.map(u,function(e){t.data.push(r[e])}),t.name=e,i.stack&&(t.stack="总量",t.areaStyle||(t.areaStyle={normal:{}})),s.push(t)}),o.series=s,o.legend.data=a,o.xAxis[0].data=u,"horizontal"===i.direction)&&(t=o.xAxis[0],o.xAxis[0]=o.yAxis[0],o.yAxis[0]=t);return o},h.pieOption={tooltip:{trigger:"item",formatter:"{b}: {c} ({d}%)"},series:[{name:" ",type:"pie",radius:"55%",center:["50%","60%"]}]},n.pieChart=function(e,n){var t=x(n,h.pieOption);console.log(t);var r,i,o=t.easySet,a=t.chartOption;return r=m.sql({select:{col:{name:o.legend,value:o.val}},from:e,orderBy:!!o.orderBy&&{value:o.orderBy}}),i=m.keyArray(r,["name"]).name,a.series[0].data=r,a.legend.data=i,a},h.kOption={tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},xAxis:[{type:"category"}],yAxis:[{type:"value"}],series:[{type:"k",itemStyle:{normal:{color:h.globalOption.color[0],color0:h.globalOption.color[0],borderColor:h.globalOption.color[0],borderColor0:h.globalOption.color[0]}}}]},n.kChart=function(e,n){var t=x(n,h.kOption),r=t.easySet,i=t.chartOption,o=[],a=i.series[0],u=m.groupBy(e,r.legend);m.sql({select:{col:{key:r.x,val:r.y}},from:e,groupBy:r.x,orderBy:!!r.orderBy&&{val:r.orderBy}}).map(function(e){var n=e.key;o.push(n)});var s,c=m.extend(!0,{},a);(c.data=[],m.forIn(u,function(e,n){m.keyArray(n,[r.y]);var t=m.index(n,r.x);m.map(o,function(e){c.data.push(t[e][r.y])})}),i.series=c,i.xAxis[0].data=o,"horizontal"===r.direction)&&(s=i.xAxis[0],i.xAxis[0]=i.yAxis[0],i.yAxis[0]=s);return i},h.mapOption={color:["#9d70e3","#9d70e3"],tooltip:{trigger:"item"},visualMap:{min:0,left:"left",top:"bottom",text:["高","低"],calculable:!0,inRange:{color:["#ddf5ff","#5fb0ff"]}},legend:{orient:"vertical",top:"bottom",left:"right"},series:[{name:"地图",type:"map",mapType:"",itemStyle:{normal:{label:{show:!0}},emphasis:{label:{show:!1}}},data:[]}]},n.mapChart=function(e,n){var t=x(n,h.mapOption),r=t.easySet,i=t.chartOption,o={},a=m.sql({select:{col:{name:r.region,value:function(n){var t=0;return m.map(r.value,function(e){o[r.region]=n,t+=n[e]}),t}}},from:e}),u=m.max(a,"value");return delete i.xAxis,delete i.yAxis,i.visualMap.max=u.value,i.series[0].data=a,i.series[0].mapType=r.mapType,i},h.boxplotOption={tooltip:{trigger:"item",formatter:function(e){return"".concat(e.name,"<br/>\n        最大值: ").concat(e.data[5],"<br/>\n        上四分位: ").concat(e.data[4],"<br/>\n        中位数: ").concat(e.data[3],"<br/>\n        下四分位: ").concat(e.data[2],"<br/>\n        最小值: ").concat(e.data[1],"\n        ")}},xAxis:[{type:"category",boundaryGap:!0,nameGap:30,splitArea:{show:!1},splitLine:{show:!1},data:[]}],yAxis:[{type:"value"}],series:[{name:"boxplot",type:"boxplot"}]},n.boxplotChart=function(e,n){var t=x(n,h.boxplotOption),o=t.easySet,r=t.chartOption,a=[],u=[],s=[],c=r.series[0],i=m.groupBy(e,o.legend),l=m.groupBy(e,o.x);return m.forIn(l,function(e){u.push(e)}),m.forIn(i,function(e,n){var r=m.extend(!0,{},c),i=m.index(n,o.x);a.push(e),r.data=[],m.map(u,function(n){var t=[];o.y.map(function(e){t.push(i[n][e])}),r.data.push(t.sort(function(e,n){return e-n}))}),r.name=e,s.push(r)}),r.series=s,r.legend.data=a,r.xAxis[0].data=u,r},h.ksOption={tooltip:{formatter:function(e){var t="";return e.map(function(e){var n=e.value;t+=e.marker+e.seriesName+"-"+e.data.type+":"+n+"<br>"}),t}},xAxis:[{type:"category",boundaryGap:!1}],yAxis:[{type:"value"}],series:[{type:"line",markLine:{animation:!1,lineStyle:{normal:{type:"solid"}},data:[[{coord:[],symbol:"none"},{coord:[],symbol:"none"}]]}},{type:"line"}]},n.ksChart=function(e,n){var t,r=x(n,h.ksOption),l=r.easySet,f=r.chartOption,p=[],d=[],y=[],i=m.groupBy(e,l.legend);(m.sql({select:{col:{key:l.x},sum:{val:l.y}},from:e,groupBy:l.x,orderBy:!!l.orderBy&&{val:l.orderBy}}).map(function(e){var n=e.key;d.push(n)}),m.forIn(i,function(o,e,n){p.push(o);var a=m.extend(!0,{},f.series[0]),u=m.extend(!0,{},f.series[1]),t=m.groupBy(e,l.type),r=m.groupBy(e,l.x),i=[],s=0;m.forIn(r,function(e,n){var t=n[0][l.y]-n[1][l.y],r=Math.abs(t);s<r&&(i=n,s=r)});var c=a.markLine.data[0];c[0].coord=[i[0][l.x],i[0][l.y]],c[1].coord=[i[1][l.x],i[1][l.y]],m.forIn(t,function(e,n,t){var r=m.extend(!0,{},0==t?a:u),i=m.index(n,l.x);r.data=[],m.map(d,function(e){r.data.push({type:i[e][l.type],value:i[e][l.y],y:i[e][l.y],x:i[e][l.x],legend:i[e][l.legend]})}),console.log(r),r.name=o,y.push(r)})}),f.series=y,f.legend.data=p,f.xAxis[0].data=d,"horizontal"===l.direction)&&(t=f.xAxis[0],f.xAxis[0]=f.yAxis[0],f.yAxis[0]=t);return f},m.forIn(h,function(e,t){n[e]=function(e,n){t=n?m.extend(!0,t,e):m.extend(t,e)}}),n});