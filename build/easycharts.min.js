var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n};!function(){var n="object"==("undefined"==typeof self?"undefined":_typeof(self))&&self.self===self&&self||"object"==("undefined"==typeof global?"undefined":_typeof(global))&&global.global===global&&global||this,e=(n.jc,Array.prototype),r=Object.prototype;e.push;slice=e.slice,toString=r.toString,hasOwnProperty=r.hasOwnProperty;var t=Array.isArray,i=Object.keys,s=Object.values?Object.values:function(e){return i(e).map(function(n){return e[n]})},f=(Object.create,function n(e){return e instanceof n?e:this instanceof n?void(this._wrapped=e):new n(e)});function a(n,e,r){return f.isNoVal(n)||f.isNoVal(e)?f.isNoVal(n)?e:n:(r="max"==r?e<n:n<e)?n:e}function l(e,n){var r={};return f.isArray(n)?f.map(n,function(n){r[e+n]=n}):f.isObject(n)?f.forIn(n,function(n,e){r[n]=e}):f.isString(n)&&(r[e+n]=n),r}function p(n,e){var i={},o=n.length,u={};return f.map(n,function(t){f.isObjEmpty(e.colObj)||f.forIn(e.colObj,function(n,e){var r=f.isFunction(e)?e(t):t[e];i[n]=r}),f.isObjEmpty(e.sumObj)||f.forIn(e.sumObj,function(n,e){var r=f.isFunction(e)?e(t):t[e];i[n]?i[n]+=r||0:i[n]=r||0}),f.isObjEmpty(e.avgObj)||f.forIn(e.avgObj,function(n,e){u[n]||(u[n]=0);var r=f.isFunction(e)?e(t):t[e];i[n]?i[n]+=r||0:i[n]=r||0,(r||0==r)&&u[n]++}),f.isObjEmpty(e.maxObj)||f.forIn(e.maxObj,function(n,e){var r=f.isFunction(e)?e(t):t[e];i[n]=a(i[n],r,"max")}),f.isObjEmpty(e.minObj)||f.forIn(e.minObj,function(n,e){var r=f.isFunction(e)?e(t):t[e];i[n]=a(i[n],r,"min")}),f.isObjEmpty(e.countObj)||f.forIn(e.countObj,function(n,e){var r=f.isFunction(e)?e(t):t[e];switch(f.isUndefined(i[n])&&(i[n]=0),n){case"*"==e?n:"count_*":i[n]=o;break;default:f.isUndefined(r)||null==r||i[n]++}})}),f.forIn(e.avgObj,function(n,e){i[n]=i[n]/u[n]}),i}function c(n,e){if(!e)return n;if(f.isObject(e)&&!f.isFunction(e)){var u=i(e),a=s(e);n.sort(function(n,e){for(var r,t,i=u.length,o=0;o<i&&(r=u[o],t=a[o],n[r]===e[r]);o++);if(n[r]!==e[r]){if(n[r]>e[r]||void 0===e[r])return"desc"===t||"DESC"===t?-1:1;if(n[r]<e[r]||void 0===n[r])return"desc"===t||"DESC"===t?1:-1}return"desc"===t||"DESC"===t?e[r]-n[r]:n[r]-e[r]})}else f.isFunction(e)&&n.sort(e);return n}function y(n,e){if(!e&&0!=e)return n;var r=[],t=n.length,i=0;if(f.isNumber(e))t=t<e?t:e;else if(f.isArray(e)){if(e[0]>t)return[];e[0]<t&&(i=e[0]),t=e[0]+e[1]<t?e[0]+e[1]:t}for(;i<t;i++)r.push(n[i]);return r}"undefined"==typeof exports||exports.nodeType?n.jc=f:("undefined"!=typeof module&&!module.nodeType&&module.exports&&(exports=module.exports=f),exports.jc=f),f.VERSION="1.1.0",f.map=function(n,e){return f.isArray(n)?n.map(e):[]},f.forIn=function(n,e){if(!f.isObject(n))return{};var r=0;for(var t in n)e(t,n[t],r),r++},f.filter=function(n,e){return f.isArray(n)?n.filter(e):[]},f.where=function(n,r){var e;if(f.isFunction(r))e=f.filter(n,r);else{if(!f.isObject(r))return[];e=f.filter(n,function(e){return i(r).every(function(n){return r[n]===e[n]})})}return e},f.limit=function(n,e){return y(n,e)},f.order=f.orderBy=function(n,e){return c(n,e)},f.tree=function(n,r){var e;r.children||(r.children="children"),f.isString(r.retain)?e=[r.retain,r.id,r.parent]:f.isArray(r.retain)?((e=r.retain).push(r.id),e.push(r.parent)):f.isObject(r.retain)?((e=r.retain)[r.id]=r.id,e[r.parent]=r.parent):n=f.extend(!0,[],n),e&&(n=f.sql({select:{col:e},from:n}));var t={},i=f.groupBy(n,function(n){return n[r.id]==r.root&&(t=n),n[r.parent]});return f.map(n,function(n){var e=n[r.id];i[e]&&(n[r.children]=i[e])}),f.isObjEmpty(t)&&(t[r.children]=i[r.root]),t},f.extend=function(){var n,e,r,t,i,o,u=arguments[0]||{},a=1,c=arguments.length,s=!1;for("boolean"==typeof u&&(s=u,u=arguments[1]||{},a++),"object"===(void 0===u?"undefined":_typeof(u))||f.isFunction(u)||(u={}),c===a&&(u=this,--a);a<c;a++)if(null!=(n=arguments[a]))for(e in n)r=u[e],u!==(t=n[e])&&(s&&t&&(f.isObject(t)||(i=f.isArray(t)))?(i?(i=!1,o=r&&f.isArray(r)?r:[]):o=r&&f.isObject(r)?r:{},u[e]=f.extend(s,o,t)):void 0!==t&&(u[e]=t));return u},f.unique=function(n){if(!n||0==n.length)return n;var r={},t=[];f.map(n,function(n){var e=JSON.stringify(n);r[e]=n});return f.forIn(r,function(n,e){t.push(e)}),t},f.spaceFix=function(n,e){if(!n||0==n.length)return n;var r=[];0<n[0][e.key]-e.start&&((s={})[e.key]=e.start,f.map(e.zeroFill,function(n){s[n]=0}),n.unshift(s));n[n.length-1][e.key]<e.end&&((s={})[e.key]=e.end,f.map(e.zeroFill,function(n){s[n]=0}),n.push(s));for(var t=1,i=n.length;t<i&&!(1e4<t);t++){var o=n[t][e.key]-n[t-1][e.key];if(o<=e.space)r.push(n[t]);else{for(var u=e.space,a=0,c=o/e.space;a<c-1&&!(1e4<a);a++){var s;(s={})[e.key]=parseInt(n[t-1][e.key])+parseInt(u),f.map(e.zeroFill,function(n){s[n]=0}),r.push(s),u+=e.space}r.push(n[t])}}return r.unshift(n[0]),r},f.keyArray=function(n,e){if(!n||0==n.length)return n;f.isString(e)&&(e=[e]);var t={};return f.map(n,function(r,n){f.map(e,function(n,e){t[n]||(t[n]=[]),t[n].push(r[n])})}),t},f.keyBreak=function(n,t){if(!n||0==n.length)return n;var i=[],o=t.key,u=t.value;return f.map(n,function(r){f.map(t.break,function(n){var e={};e[o]=n,e[u]=r[n],f.map(t.retain,function(n){e[n]=r[n]}),i.push(e)})}),i},f.index=function(n,e){if(!n||0==n.length)return n;var r={};return f.map(n,function(n){r[n[e]]=n}),r},f.max=function(n,t){if(!n||0==n.length)return n;var i;if(f.isString(t)){var e=t;t=function(n){return n[e]}}else f.isUndefined(t)&&(t=function(n){return n});return f.map(n,function(n){var e=i?t(i):i,r=n?t(n):n;i=f.isNoVal(e)||f.isNoVal(r)?f.isNoVal(e)?n:i:r<e?i:n}),i},f.min=function(n,t){if(!n||0==n.length)return n;var i;if(f.isString(t)){var e=t;t=function(n){return n[e]}}else f.isUndefined(t)&&(t=function(n){return n});return f.map(n,function(n){var e=i?t(i):i,r=n?t(n):n;i=f.isNoVal(e)||f.isNoVal(r)?f.isNoVal(e)?n:i:e<r?i:n}),i},f.group=f.groupBy=function(n,e){if(!n||0==n.length)return n;var i={};return f.map(n,function(r,n){var t=[];f.isArray(e)?f.map(e,function(n,e){f.isFunction(n)?t.push(n(r)):t.push(r[n])}):f.isString(e)?t.push(r[e]):f.isFunction(e)&&(t=e(r,n)),i[t]||(i[t]=[]),i[t].push(r)}),i},f.sql=function(n){if(function(n){if(!n.from)throw new Error("From is not defined","Error from");if(!n.select)throw new Error("Select is not defined","Error select");!function(n){var e=n.select,r=n.groupBy;if(!(e.sum||e.avg||e.count||e.max||e.min))return;if(e.col&&!n.groupBy)return;var t=l("",e.col);t=s(t);var i=[],o=!1;f.isArray(r)?f.map(r,function(n,e){i.push(n)}):f.isString(r)?i.push(r):f.isFunction(r)&&(i=[r]);for(var u=0,a=t.length;u<a;u++){for(var c=0;c<a;c++){if(t[u]==i[c]){o=!0;break}if(f.isObject(t[u])&&f.isObject(i[c])&&String(t[u])===String(i[c])){o=!0;break}}if(!o)throw new Error("groupBy should contain select.col","Error groupBy");o=!1}}(n)}(n),0==n.from.length||!f.isArray(n.from))return[];var e,r,t,i,o,u,a=n.from;return r=a,e=(t=n.where)?f.where(r,t):r,i=e,o=n,f.forIn(o.select,function(n,e){u=!("col"==n)||u}),y(c(function(n,e){if(!e)throw new Error("Select is not defined","Error select");var o=[],u={};e.col&&(u.colObj=l("",e.col));e.sum&&(u.sumObj=l("sum_",e.sum));e.avg&&(u.avgObj=l("avg_",e.avg));e.max&&(u.maxObj=l("max_",e.max));e.min&&(u.minObj=l("min_",e.min));e.count&&(u.countObj=l("count_",e.count));f.isArray(n)?f.map(n,function(n,e){var r=p([n],u);o.push(r)}):f.forIn(n,function(n,e,r,t){var i=p(e,u);o.push(i)});return o}(function(n,a){if(!a)return n;var c={sumObj:{},avgObj:{},maxObj:{},minObj:{},countObj:{}},s={};return f.forIn(a,function(n,e){var r=n.split("_"),t=r.shift(),i=r.join("_");switch(i=i.replace(/[1-9a-zA-z_\$\@]+/g,function(n){return"row['"+n+"']"}),t){case"sum":c.sumObj[n]=function(n){return new Function("row","return "+i)(n)};break;case"avg":c.avgObj[n]=function(n){return new Function("row","return "+i)(n)};break;case"max":c.maxObj[n]=function(n){return new Function("row","return "+i)(n)};break;case"min":c.minObj[n]=function(n){return new Function("row","return "+i)(n)};break;case"count":c.countObj[n]=function(n){return new Function("row","return "+i)(n)}}}),f.forIn(n,function(n,e,r,t){var i,o=p(e,c);for(var u in a)if(foo=new Function("return "+o[u]+a[u]),!(i=foo()))break;i&&(s[n]=e)}),s}(o.groupBy||u?o.groupBy||o.select.col?f.group(i,o.groupBy):{table:i}:i,n.having),n.select),n.orderBy),n.limit)},f.isObjEmpty=function(n){for(var e in n)return!1;return!0},f.isNoVal=function(n){return f.isUndefined(n)||null==n||n!=n},f.isArray=t||function(n){return"[object Array]"===toString.call(n)},f.isObject=function(n){return"object"===(void 0===n?"undefined":_typeof(n))&&!f.isArray(n)&&!!n},f.map(["Arguments","Function","String","Number","Date","RegExp","Error","Symbol","Map","WeakMap","Set","WeakSet"],function(e){f["is"+e]=function(n){return toString.call(n)==="[object "+e+"]"}}),f.isUndefined=function(n){return void 0===n},"function"==typeof define&&define.amd&&define("jc",[],function(){return f})}(),function(){var n="object"==("undefined"==typeof self?"undefined":_typeof(self))&&self.self===self&&self||"object"==("undefined"==typeof global?"undefined":_typeof(global))&&global.global===global&&global||this,e=(n.ec,Array.prototype),r=Object.prototype,t=(e.push,e.slice,r.toString,r.hasOwnProperty,Array.isArray,Object.keys),i=(Object.values&&Object.values,Object.create,function n(e){return e instanceof n?e:this instanceof n?void(this._wrapped=e):new n(e)});"undefined"==typeof exports||exports.nodeType?n.ec=i:("undefined"!=typeof module&&!module.nodeType&&module.exports&&(exports=module.exports=i),exports.ec=i),i.VERSION="1.0.0";var l={globalOption:{color:["#1890FF","#2FC25B","#FACC14","#223273","#8543E0","#13C2C2","#3436C7","#F04864"],tooltip:{trigger:"axis"},grid:{top:48,left:16,right:16,bottom:12,containLabel:!0},title:{text:"",top:4,left:10,textStyle:{color:"#333"}},legend:{show:!0,top:8,right:10}}};getOption=function(n,e){var r=jc.extend(!0,{},l.globalOption);r=jc.extend(!0,r,e);var t=void 0;return n.easySet?(r=jc.extend(!0,r,n),t=n.easySet,delete r.easySet):t=n,{chartOption:r,easySet:t}},l.barOption={tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},xAxis:[{type:"category"}],yAxis:[{type:"value"}],series:[{type:"bar"}]},i.barChart=function(n,e){var r=getOption(e,l.barOption),i=r.easySet,t=r.chartOption,o=[],u=[],a=[],c=t.series[0],s=jc.groupBy(n,i.legend);if(jc.sql({select:{col:{key:i.x},sum:{val:i.y}},from:n,groupBy:i.x,orderBy:!!i.orderBy&&{val:i.orderBy}}).map(function(n){var e=n.key;u.push(e)}),jc.forIn(s,function(n,e){jc.keyArray(e,[i.y]);var r=jc.extend(!0,{},c),t=jc.index(e,i.x);o.push(n),r.data=[],jc.map(u,function(n){r.data.push(t[n][i.y])}),r.name=n,i.stack&&(r.stack="总量"),a.push(r)}),t.series=a,t.legend.data=o,t.xAxis[0].data=u,"horizontal"===i.direction){var f;f=t.xAxis[0],t.xAxis[0]=t.yAxis[0],t.yAxis[0]=f}return t},l.lineOption={xAxis:[{type:"category",boundaryGap:!1}],yAxis:[{type:"value"}],series:[{type:"line"}]},i.lineChart=function(n,e){var r=getOption(e,l.lineOption),i=r.easySet,t=r.chartOption,o=[],u=[],a=[],c=t.series[0],s=jc.groupBy(n,i.legend);if(jc.sql({select:{col:{key:i.x},sum:{val:i.y}},from:n,groupBy:i.x,orderBy:!!i.orderBy&&{val:i.orderBy}}).map(function(n){var e=n.key;u.push(e)}),jc.forIn(s,function(n,e){jc.keyArray(e,[i.y]);var r=jc.extend(!0,{},c),t=jc.index(e,i.x);o.push(n),r.data=[],jc.map(u,function(n){r.data.push(t[n])}),r.name=n,i.stack&&(r.stack="总量",r.areaStyle||(r.areaStyle={normal:{}})),a.push(r)}),t.series=a,t.legend.data=o,t.xAxis[0].data=u,"horizontal"===i.direction){var f;f=t.xAxis[0],t.xAxis[0]=t.yAxis[0],t.yAxis[0]=f}return t},l.pieOption={tooltip:{trigger:"item",formatter:"{b}: {c} ({d}%)"},series:[{name:" ",type:"pie",radius:"55%",center:["50%","60%"]}]},i.pieChart=function(n,e){var r,t,i=getOption(e,l.pieOption),o=i.easySet,u=i.chartOption;return r=jc.sql({select:{col:{name:o.legend,value:o.val}},from:n,orderBy:!!o.orderBy&&{value:o.orderBy}}),t=jc.keyArray(r,["name"]).name,u.series[0].data=r,u.legend.data=t,u},jc.forIn(l,function(n,r){i[n]=function(n,e){r=e?jc.extend(!0,r,n):jc.extend(r,n)}}),"function"==typeof define&&define.amd&&define("ec",[],function(){return i})}();